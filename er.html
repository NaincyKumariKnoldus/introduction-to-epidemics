

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Making fewer connections &#8212; Epidemic modelling &amp;ndash; Some notes, maths, and code</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/jupyter-sphinx.css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/sphinx-book-theme.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/mystnb.js"></script>
    <script src="_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .secondtoggle, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="copyright" title="Copyright" href="copyright.html" />
    <link rel="next" title="Contact tracing" href="tracing.html" />
    <link rel="prev" title="Network models" href="network.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  
  <h1 class="site-logo" id="site-title">Epidemic modelling &ndash; Some notes, maths, and code</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  
  <ul class="nav sidenav_l1">
  <li class="">
    <a href="index.html">Epidemic modelling – Some notes, maths, and code</a>
  </li>
  <li class="">
    <a href="model.html">Models and modelling</a>
  </li>
  <li class="">
    <a href="progress.html">The progession of a disease</a>
  </li>
  <li class="">
    <a href="continuous.html">SIR</a>
  </li>
  <li class="">
    <a href="network.html">Network models</a>
  </li>
  <li class="active">
    <a href="">Making fewer connections</a>
  </li>
  <li class="">
    <a href="tracing.html">Contact tracing</a>
  </li>
  <li class="">
    <a href="thresholds.html">Epidemic threshold</a>
  </li>
  <li class="">
    <a href="hcn.html">Human contact networks</a>
  </li>
  <li class="">
    <a href="zbibliography.html">Annotated bibliography</a>
  </li>
  <li class="">
    <a href="notes.html">Notes on production</a>
  </li>
  <li class="">
    <a href="acknowledgements.html">Acknowledgements</a>
  </li>
  <li class="">
    <a href="about.html">About the author</a>
  </li>
  <li class="">
    <a href="copyright.html">Copyright</a>
  </li>
</ul>
</nav>
<p class="navbar_footer">Powered by <a href="https://jupyterbook.org">Jupyter Book</a></p>
</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse" data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu" aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation" title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
            <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i class="fas fa-download"></i></button>

            
            <div class="dropdown-buttons">
                <!-- ipynb file if we had a myst markdown file -->
                
                <!-- Download raw file -->
                <a class="dropdown-buttons" href="_sources/er.ipynb.txt"><button type="button" class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip" data-placement="left">.ipynb</button></a>
                <!-- Download PDF via print -->
                <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF" onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
            </div>
            
        </div>

        <!-- Edit this page -->
        

        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->
        
        <div class="dropdown-buttons-trigger">
            <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
            <div class="dropdown-buttons">
                
                <a class="binder-button" href="https://mybinder.org/v2/gh/simoninireland/introduction-to-epidemics/master?urlpath=tree/er.ipynb"><button type="button" class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip" data-placement="left"><img class="binder-button-logo" src="_static/images/logo_binder.svg" alt="Interact on binder">Binder</button></a>
                
                
                
            </div>
        </div>
        
    </div>
    <div class="d-none d-md-block col-md-2 bd-toc show">
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="nav section-nav flex-column">
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#characterising-a-network-s-topology" class="nav-link">Characterising a network’s topology</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#er-networks" class="nav-link">ER networks</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h3">
            <a href="#building-er-networks" class="nav-link">Building ER networks</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#epidemic-spreading-on-er-networks" class="nav-link">Epidemic spreading on ER networks</a>
        </li>
    
    </ul>
</nav>


    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="making-fewer-connections">
<h1>Making fewer connections<a class="headerlink" href="#making-fewer-connections" title="Permalink to this headline">¶</a></h1>
<p>If the complete graph is a representation of complete mixing, how do we represent “incomplete” mixing? With an <em>incomplete</em> graph, obviously…</p>
<p>Of course while there can only be one complete graph with a given number of nodes, once we start talking about incomplete graphs we have a huge number of options. We could have a network with <em>no</em> edges. (How would an epidemic spread over this network?) Or we could have a network that had a very uneven distribution of edges. Perhaps we could even extract a “real” social network from facebook or Twitter data.</p>
<p>The structure of a network is referred to mathematically as its <strong>topology</strong>. You can think of this as being “the way it’s connected” What we’re talking about, then, is exploring how the SIR process spreads over networks with different topologies.</p>
<div class="section" id="characterising-a-network-s-topology">
<h2>Characterising a network’s topology<a class="headerlink" href="#characterising-a-network-s-topology" title="Permalink to this headline">¶</a></h2>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>In the networks we’ll be considering for now the degree of a node is fixed when the network is created. Later on when we encounter adaptive networks degree itself becomes a process that changes with time.</p>
</div>
<p>Since we have a range of different topologies, we’ll need some way of describing their properties so thhat we can tell them apart. There are a huge number of such <strong>graph metrics</strong> that have been developed, and we’ll encounter a few them in the course of this book. For the time being, we’ll start with the most influential number, the <strong>degree</strong> of a node, which is simply the number of edges intersecting each node. Each node has its own degree. In your social network, the degree of the node that represents you is simply the number of people you’re connected to. The degree of a node is usually denoted <span class="math notranslate nohighlight">\(k\)</span>, for no particular reason.</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><span class="math notranslate nohighlight">\(\langle k \rangle\)</span> is usually pronounced “k mean”.</p>
</div>
<p>For a given network we can enumerate the degrees of every node, but that’s clearly not going to be very useful for a large network: you wouldn’t be able to extract any useful information from the large list of numbers. But we can derive two statistics from suchh lists. The first is the <strong>mean degree</strong>, the “average” degree of a node, denoted <span class="math notranslate nohighlight">\(\langle k \rangle\)</span>. While the degree of every node has to be an integer (you can’t have half a friend), the mean degree of the population overall will typically be a real number.</p>
<p>For the complete graph every node has exactly the same degree, being one less that the number of nodes in the network, since there’s an edge between every node and every other (except itself). This means that <span class="math notranslate nohighlight">\(k\)</span> is always <span class="math notranslate nohighlight">\((N - 1)\)</span> for every node, and therefore so is <span class="math notranslate nohighlight">\(\langle k \rangle\)</span>.</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>If this use of the word “distribution” sounds like it should be connected to probability theory – it is. The degree histogram is a shows the relative numbers of nodes with each different degree, and so defines the probability of randomly choosing a node with degree <span class="math notranslate nohighlight">\(k\)</span>. <span class="math notranslate nohighlight">\(\langle k \rangle\)</span> is then the expected value of the degree.</p>
</div>
<p>In general things will be more complicated. The degrees of nodes in a network form a <strong>degree distribution</strong>, which we can plot as a histogram to show the number of nodes with each degree. (we do this below.) If we use <span class="math notranslate nohighlight">\(N\)</span> to represent the number of nodes in the network, we’ll use <span class="math notranslate nohighlight">\(N_k\)</span> to represent the number of nodes with degree <span class="math notranslate nohighlight">\(k\)</span>. Then we can compute <span class="math notranslate nohighlight">\(\langle k \rangle\)</span> very easily from this distibution, by summing up the numbers of ndoes with each degree and then dividing by the number of nodes.</p>
<div class="math notranslate nohighlight">
\[
    \langle k \rangle = \frac{\sum_k N_k}{N}
\]</div>
<p>There are a lot of other metrics that we could consider, but the degree distribution is the most important and well-studied. It’s not the whole story, however, because there are will be a <em>lot</em> of different networks with the <em>same</em> degree distribution and mean degree, depending on exactly how the edges trhat intersect each node connect to other nodes. So while one side of network toppology is captured by statistics, there’s another side that concerns the details of which nodes are <strong>adjacent</strong> to each other by having an edge between them: it matters who your friends are, not just how many you have. We sometimes call the set of nodes adjacent to a node its <strong>neighbours</strong>.</p>
</div>
<div class="section" id="er-networks">
<h2>ER networks<a class="headerlink" href="#er-networks" title="Permalink to this headline">¶</a></h2>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Paul Erdős (pronounced “AIR-dish”) was the most prolific mathematician of the 20th
century. A peripatetic genius, he owned essentially nothing and
travelled between the university mathematics schools seeking problems to work on.
His biography <a class="bibtex reference internal" href="zbibliography.html#hof98" id="id1">[Hof98]</a> provides a fascinating insight into mathematical life.
Alfred Rényi was a noted mathematician whose other work has been
rather overshadowed by his wonderfully productive association with
Erdős. He was also responsible for the definition of a mathematician as
“a machine for turning coffee into theorems”.</p>
</div>
<p>Let’s start with one of the simplest non-complete topologies. This topology was initially explored in depth in the late 1950’s by Paul Erdős and Alfred Rényi <a class="bibtex reference internal" href="zbibliography.html#er59" id="id2">[ER59]</a>. They called their approach “random graphs”, but that’s a slightly misleading name: we can produce “random” networks with <em>any</em> topology as we saw above. Fortunately the influence of Erdős and Rényi has been so profound that networks of this type are now referred to as <strong>Erdős-Rényi</strong> or <strong>ER networks</strong>.</p>
<p>The idea of an ER network is that there exists an edge between any pair of nodes with some fixed probability, and the existence of any edge is independent of the existence of any other.</p>
<div class="section" id="building-er-networks">
<span id="sec-er-building"></span><h3>Building ER networks<a class="headerlink" href="#building-er-networks" title="Permalink to this headline">¶</a></h3>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Again, in the literature <span class="math notranslate nohighlight">\(p_{edge}\)</span> is usually denoted <span class="math notranslate nohighlight">\(\phi\)</span>.</p>
</div>
<p>From this simple description of the degree distributiuon, an ER network is also very simple to build. Pick a number of nodes <span class="math notranslate nohighlight">\(N\)</span>, and build the complete graph <span class="math notranslate nohighlight">\(K_N\)</span>. Remember that the complete graph has an edge between every pair of nodes. Now pick a parameter <span class="math notranslate nohighlight">\(p_{edge}\)</span> between <span class="math notranslate nohighlight">\(0\)</span> and <span class="math notranslate nohighlight">\(1\)</span>. Work through all the edges, and for each edge pick a random number <span class="math notranslate nohighlight">\(s\)</span> between <span class="math notranslate nohighlight">\(0\)</span> ands <span class="math notranslate nohighlight">\(1\)</span>. If <span class="math notranslate nohighlight">\(s \le p_{edge}\)</span> then keep the edge; if <span class="math notranslate nohighlight">\(s \gt p_{edge}\)</span>, remove it. You’ll end up with a network in which there’s an edge between each pair of nodes with a probability <span class="math notranslate nohighlight">\(p_{edge}\)</span>. If <span class="math notranslate nohighlight">\(p_{edge} = 1\)</span> we have the complete graph (we <em>always</em> keep an edge); if <span class="math notranslate nohighlight">\(p_{edge} = 0\)</span> we have the empty graph (we <em>never</em> keep an edge); and for values in between we have a more or less sparse collection of edges.</p>
<p>Drawing the result can help get the idea straight.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>

<span class="c1"># a small network to visualise</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">20</span>

<span class="c1"># draw the network for different values of phi</span>
<span class="k">for</span> <span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span> <span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]),</span>
                   <span class="p">(</span><span class="mf">0.10</span><span class="p">,</span> <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]),</span>
                   <span class="p">(</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]),</span>
                   <span class="p">(</span><span class="mf">0.50</span><span class="p">,</span> <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]),</span>
                   <span class="p">(</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]),</span>
                   <span class="p">(</span><span class="mf">0.99</span><span class="p">,</span> <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="p">]:</span>
    <span class="c1"># create a random ER network</span>
    <span class="n">G</span> <span class="o">=</span> <span class="n">networkx</span><span class="o">.</span><span class="n">erdos_renyi_graph</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">phi</span><span class="p">)</span>
    
    <span class="c1"># draw the network in the sub-plot</span>
    <span class="n">networkx</span><span class="o">.</span><span class="n">draw_circular</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;$p_</span><span class="si">{edge}</span><span class="s1"> = &#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="si">{p}</span><span class="s1">$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">phi</span><span class="p">))</span>
        
<span class="c1"># fine-tune the figure</span>
<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;ER networks for different values of $p_</span><span class="si">{edge}</span><span class="s1">$ &#39;</span> <span class="o">+</span> <span class="s1">&#39;($N = </span><span class="si">{n}</span><span class="s1">)$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">N</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/er_9_0.svg" src="_images/er_9_0.svg" /></div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>We sometimes denote the ER network with <span class="math notranslate nohighlight">\(N\)</span> nodes and a connection probability <span class="math notranslate nohighlight">\(p_{edge}\)</span> by <span class="math notranslate nohighlight">\(G_{N, p_{edge}}\)</span>.</p>
</div>
<p>At the top left where <span class="math notranslate nohighlight">\(p_{edge}\)</span> is small, we have very few edges: 5% of the possible total, in fact. As we progress towards the bottom right the network gets more and more dense, until at 99% of the possible edges it’s quite hard to spot that any are actually missing at all.</p>
<p>What is <span class="math notranslate nohighlight">\(\langle k \rangle\)</span> for this topology? The answer turns out to be quite simple. An ER network has <span class="math notranslate nohighlight">\(\langle k \rangle = \frac{p_{edge}}{N}\)</span>. Moreover the degree distribution – the number of nodes with more, or less, edges than the mean, is a <strong>normal</strong> distribution, the “bell curve” we see in many phenomena.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>

<span class="c1"># a sample network</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">kmean</span> <span class="o">=</span> <span class="mi">40</span>
<span class="n">phi</span> <span class="o">=</span> <span class="p">(</span><span class="n">kmean</span> <span class="o">+</span> <span class="mf">0.0</span><span class="p">)</span> <span class="o">/</span> <span class="n">N</span>

<span class="c1"># build the network</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">networkx</span><span class="o">.</span><span class="n">gnp_random_graph</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">phi</span><span class="p">)</span>
<span class="c1">#G = networkx.erdos_renyi_graph(N, phi)</span>

<span class="c1"># draw the degree distribution</span>
<span class="n">ks</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">networkx</span><span class="o">.</span><span class="n">degree</span><span class="p">(</span><span class="n">g</span><span class="p">))</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">ks</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="n">ks</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ER network degree distribution ($N = </span><span class="si">{n}</span><span class="s1">, </span><span class="se">\\</span><span class="s1">langle k </span><span class="se">\\</span><span class="s1">rangle = </span><span class="si">{k}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="n">kmean</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;, p_</span><span class="si">{edge}</span><span class="s1"> = &#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="si">{p}</span><span class="s1">$)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">phi</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$k$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$N_k$&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;degree-distribution-er.svg&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/er_11_0.svg" src="_images/er_11_0.svg" /></div>
</div>
<p>So about one-third of the nodes (about 34000) have a degree around the mean (20), with the number of nodes having more (or less) neighbours dropping off on either side of the mean. There are very few nodes with degrees in single figures, and very few with degrees of twice the mean – and none with really large degree. In fact for any network there will be a <strong>minimum degree</strong> <span class="math notranslate nohighlight">\(k_{min}\)</span> and a <strong>maximum degree</strong> <span class="math notranslate nohighlight">\(k_{max}\)</span>. The ER network’s degree distribution says that the maximum degree is never “too far” from the mean.</p>
</div>
</div>
<div class="section" id="epidemic-spreading-on-er-networks">
<span id="sec-er-spreading"></span><h2>Epidemic spreading on ER networks<a class="headerlink" href="#epidemic-spreading-on-er-networks" title="Permalink to this headline">¶</a></h2>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>From now on we’ll mainly use <span class="math notranslate nohighlight">\(\langle k \rangle\)</span> as the parameter for ER networks rather than <span class="math notranslate nohighlight">\(\phi\)</span>: we can convert between them easily, and <span class="math notranslate nohighlight">\(\langle k \rangle\)</span> is a more intuitive idea.</p>
</div>
<p>After all that network science we can finally ask ourselves a disease-related question: what happens as we vary <span class="math notranslate nohighlight">\(\langle k \rangle\)</span>? We already know that when <span class="math notranslate nohighlight">\(\langle k \rangle = (N - 1)\)</span> the network has complete mixing. But what happens as <span class="math notranslate nohighlight">\(\langle k \rangle\)</span> gets <em>smaller</em> – that is, people have fewer and fewer contacts with each other – for the <em>same</em> disease? We’d presumably expect that fewer people will become infected overall, which also suggests that at some point the disease will simply die out without affecting very many people at all.</p>
<p>Let’s see.</p>
<p>We’ll take the same parameters for the size of the network and the disease that we had before.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">2000</span>
<span class="n">T</span> <span class="o">=</span> <span class="mi">5000</span>
<span class="n">pInfected</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="n">pInfect</span> <span class="o">=</span> <span class="mf">0.0001</span>
<span class="n">pRemove</span> <span class="o">=</span> <span class="mf">0.001</span>
</pre></div>
</div>
</div>
</div>
<p>But instead of building a complete graph we’ll build ER networks and see what happens as we change <span class="math notranslate nohighlight">\(\langle k \rangle\)</span>.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>

<span class="c1"># draw sub-plots for the different values of kmean </span>
<span class="k">for</span> <span class="p">(</span><span class="n">kmean</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span>  <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]),</span>
                     <span class="p">(</span><span class="mi">20</span><span class="p">,</span>  <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]),</span>
                     <span class="p">(</span><span class="mi">30</span><span class="p">,</span>  <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]),</span>
                     <span class="p">(</span><span class="mi">40</span><span class="p">,</span>  <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]),</span>
                     <span class="p">(</span><span class="mi">50</span><span class="p">,</span>  <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]),</span>
                     <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="p">]:</span>
    <span class="c1"># create an ER network</span>
    <span class="n">phi</span> <span class="o">=</span> <span class="p">(</span><span class="n">kmean</span> <span class="o">+</span> <span class="mf">0.0</span><span class="p">)</span> <span class="o">/</span> <span class="n">N</span>
    <span class="n">g</span> <span class="o">=</span> <span class="n">networkx</span><span class="o">.</span><span class="n">gnp_random_graph</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">phi</span><span class="p">)</span>
    
    <span class="c1"># run the corresponding simulation</span>
    <span class="p">(</span><span class="n">sim_ts</span><span class="p">,</span> <span class="n">sim_sss</span><span class="p">,</span> <span class="n">sim_iss</span><span class="p">,</span> <span class="n">sim_rss</span><span class="p">)</span> <span class="o">=</span> <span class="n">network_sir</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">pInfected</span><span class="p">,</span> <span class="n">pInfect</span><span class="p">,</span> <span class="n">pRemove</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sim_ts</span><span class="p">,</span> <span class="n">sim_sss</span><span class="p">,</span> <span class="s1">&#39;rx&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;suceptible&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sim_ts</span><span class="p">,</span> <span class="n">sim_iss</span><span class="p">,</span> <span class="s1">&#39;gx&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;infected&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">langle k </span><span class="se">\\</span><span class="s1">rangle = </span><span class="si">{k}</span><span class="s1">$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="n">kmean</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">N</span><span class="p">])</span>
        
<span class="c1"># fine-tune the figure</span>
<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;SIR over ER networks ($N = </span><span class="si">{n}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">N</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;, p_{</span><span class="se">\\</span><span class="s1">mathit</span><span class="si">{Infect}</span><span class="s1">} = &#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="si">{b:.4f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="n">pInfect</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;, p_</span><span class="si">{remove}</span><span class="s1"> = &#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="si">{a}</span><span class="s1">$)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">pRemove</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]:</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;population that is...&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]:</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$t$&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;center right&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/er_20_0.svg" src="_images/er_20_0.svg" /></div>
</div>
<p>Compare these graphs to the ones earlier, and you’ll see the same shapes: changing <span class="math notranslate nohighlight">\(\langle k \rangle\)</span> has the same effect as changing <span class="math notranslate nohighlight">\(p_{\mathit{infect}}\)</span> in terms of moving the peak of infections.</p>
</div>
</div>


              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="network.html" title="previous page">Network models</a>
    <a class='right-next' id="next-link" href="tracing.html" title="next page">Contact tracing</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Simon Dobson<br/>
        
            &copy; <a href="copyright.html">Copyright</a> 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="_static/js/index.js"></script>
    
  </body>
</html>