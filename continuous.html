

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>SIR &#8212; Epidemic modelling &amp;ndash; Some notes, maths, and code</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/jupyter-sphinx.css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/sphinx-book-theme.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/mystnb.js"></script>
    <script src="_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .secondtoggle, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="copyright" title="Copyright" href="copyright.html" />
    <link rel="next" title="Network models" href="network.html" />
    <link rel="prev" title="The progession of a disease" href="progress.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  
  <h1 class="site-logo" id="site-title">Epidemic modelling &ndash; Some notes, maths, and code</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  
  <ul class="nav sidenav_l1">
  <li class="">
    <a href="index.html">Epidemic modelling – Some notes, maths, and code</a>
  </li>
  <li class="">
    <a href="model.html">Models and modelling</a>
  </li>
  <li class="">
    <a href="progress.html">The progession of a disease</a>
  </li>
  <li class="active">
    <a href="">SIR</a>
  </li>
  <li class="">
    <a href="network.html">Network models</a>
  </li>
  <li class="">
    <a href="er.html">Making fewer connections</a>
  </li>
  <li class="">
    <a href="tracing.html">Contact tracing</a>
  </li>
  <li class="">
    <a href="thresholds.html">Epidemic threshold</a>
  </li>
  <li class="">
    <a href="hcn.html">Human contact networks</a>
  </li>
  <li class="">
    <a href="herd.html">Herd immunity</a>
  </li>
  <li class="">
    <a href="vaccination.html">Vaccination</a>
  </li>
  <li class="">
    <a href="zbibliography.html">Annotated bibliography</a>
  </li>
  <li class="">
    <a href="notes.html">Notes on production</a>
  </li>
  <li class="">
    <a href="acknowledgements.html">Acknowledgements</a>
  </li>
  <li class="">
    <a href="about.html">About the author</a>
  </li>
  <li class="">
    <a href="copyright.html">Copyright</a>
  </li>
</ul>
</nav>
<p class="navbar_footer">Powered by <a href="https://jupyterbook.org">Jupyter Book</a></p>
</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse" data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu" aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation" title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
            <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i class="fas fa-download"></i></button>

            
            <div class="dropdown-buttons">
                <!-- ipynb file if we had a myst markdown file -->
                
                <!-- Download raw file -->
                <a class="dropdown-buttons" href="_sources/continuous.ipynb.txt"><button type="button" class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip" data-placement="left">.ipynb</button></a>
                <!-- Download PDF via print -->
                <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF" onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
            </div>
            
        </div>

        <!-- Edit this page -->
        

        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->
        
        <div class="dropdown-buttons-trigger">
            <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
            <div class="dropdown-buttons">
                
                <a class="binder-button" href="https://mybinder.org/v2/gh/simoninireland/introduction-to-epidemics/master?urlpath=tree/continuous.ipynb"><button type="button" class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip" data-placement="left"><img class="binder-button-logo" src="_static/images/logo_binder.svg" alt="Interact on binder">Binder</button></a>
                
                
                
            </div>
        </div>
        
    </div>
    <div class="d-none d-md-block col-md-2 bd-toc show">
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="nav section-nav flex-column">
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#sir-a-compartmented-model-of-disease" class="nav-link">SIR: A compartmented model of disease</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#the-mathematical-model" class="nav-link">The mathematical model</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#the-computational-model" class="nav-link">The computational model</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#consequences" class="nav-link">Consequences</a>
        </li>
    
    </ul>
</nav>


    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="sir">
<h1>SIR<a class="headerlink" href="#sir" title="Permalink to this headline">¶</a></h1>
<p>All disease models share some commonalities. Each model will need to represent the population of people being modelled, some (or all) of whom will get the disease in the course of the outbreak. It will need to represent the progress of the disease, as people are infected, become infectious, recover, and so forth. It will need some notion of how the disease spreads between people. And it will need to represent the disease dynamics: how long the various stages of the disease take, how virulently it spreads in the population, and so on.</p>
<p>There are many different ways to represent these phenomena, and each choice gives rise to a different modelling approach. There are a lot of trade-offs to be made, with more detail allowing more subtle issues to be captured and explored at the cost of making the model more complicated to understand and compute.</p>
<p>Let’s start with what is perhaps the simplest model of an epidemic, the <em>SIR model</em>.</p>
<div class="section" id="sir-a-compartmented-model-of-disease">
<h2>SIR: A compartmented model of disease<a class="headerlink" href="#sir-a-compartmented-model-of-disease" title="Permalink to this headline">¶</a></h2>
<p>SIR is referred to as a <em>compartmented model</em> of disease. It represents the progress of the disease by specifying a umber of states or <em>compartments</em>, with everyone in the population being assigned to exactly one compartment at anytime. The disease progresses by having people move between compartments according to some process.</p>
<p>SIR, as its name suggests, uses three compartments:</p>
<ul class="simple">
<li><p><em>Susceptible (S)</em>, representing those people who can catch the disease;</p></li>
<li><p><em>Infected (I)</em>, representing those people who have cauight the disease and can pass it on; and</p></li>
<li><p><em>Removed (R)</em>, representing those people whose infection has resolved itself and have been “removed” from progressing the disease any further.</p></li>
</ul>
<p>Notice how simple this is. A person is either infected, or they’re not. If they <em>are</em> infected, they are infectious: there’s no latency. And they’re “removed” when their infection resolves, without us noting whether they recovered or died.</p>
<p>You might ask whether something this simple can tell us anything: does any real disease work like this? But the simplicity of the model amkes it tractable and easy to study, and once we’ve got a feel for how these things work we can if desired move onto more detailed models. SIR is just one of the possible compartmented models: the others include SIS (for diseases where you can be re-infected once recovered), SEIR (for diseases with an infectious period when someone has been “exposed”), MSEIR (for diseases with maternally-conferred temporary immunity), so so on in dizzying array (see Hethcote<a class="bibtex reference internal" href="zbibliography.html#heth00" id="id1">[Het00]</a> for a more detailed discussion).</p>
</div>
<div class="section" id="the-mathematical-model">
<h2>The mathematical model<a class="headerlink" href="#the-mathematical-model" title="Permalink to this headline">¶</a></h2>
<p>We now need to describe how individuals move between compartments.  Actually we’ll simply talk about the <em>numbers</em> of people in each compartment at each time, and how those numbers change: we won’t track the disease’s progress in a specific individual (there’s a whole class of <em>agent-based</em> models that do do this).</p>
<p>Suppose we have a population of size <span class="math notranslate nohighlight">\(N\)</span>. Let’s represent the number of pewople in each compartment by <span class="math notranslate nohighlight">\(S\)</span>, <span class="math notranslate nohighlight">\(I\)</span>, and <span class="math notranslate nohighlight">\(R\)</span> respectively. Everyone in the population is assigned to exactly one compartment at any time, so always <span class="math notranslate nohighlight">\(S + I + R = N\)</span> as the sub-populations <span class="math notranslate nohighlight">\(S\)</span>, <span class="math notranslate nohighlight">\(I\)</span>, and <span class="math notranslate nohighlight">\(R\)</span> change.</p>
<p>How does someone become infected? – that is to say, how does someone move between compartment <span class="math notranslate nohighlight">\(S\)</span> and compartment <span class="math notranslate nohighlight">\(I\)</span>? In SIR we assume that the infection passes through contact between a susceptible individual and an infected one. If we further assume that everyone in the population meets everyone else equally often, then there will be <span class="math notranslate nohighlight">\(S \times I = SI\)</span> encounters between susceptible and infected individuals in each time period. Think of the population as crowd milling around, some of whom are infected.</p>
<p>Clearly not all of these interactions will result in an infection, but some fraction will, and the result will be that and an individual moves from <span class="math notranslate nohighlight">\(S\)</span> to <span class="math notranslate nohighlight">\(I\)</span>: remember that in SIR we assume that the disease passes on instantly. Let’s refer to this as <span class="math notranslate nohighlight">\(p_{\mathit{infect}}\)</span>, the probability that an <span class="math notranslate nohighlight">\(I\)</span> will infect an <span class="math notranslate nohighlight">\(S\)</span> in a single contact. There are <span class="math notranslate nohighlight">\(SI\)</span> contacts in each timestep, of which a fraction <span class="math notranslate nohighlight">\(p_{\mathit{infect}}\)</span> will result in an infection. Putting this all together, the size of <span class="math notranslate nohighlight">\(S\)</span> will <em>reduce</em> by <span class="math notranslate nohighlight">\(p_{\mathit{infect}} \, SI\)</span> (because the disease causes people to leave <span class="math notranslate nohighlight">\(S\)</span> by becoming infected).</p>
<p>If <span class="math notranslate nohighlight">\(S\)</span> is the number of susceptible people, we can denote the <em>change</em> in <span class="math notranslate nohighlight">\(S\)</span> by <span class="math notranslate nohighlight">\(\Delta S\)</span>, the difference in <span class="math notranslate nohighlight">\(S\)</span> at each timestep. As the disease progresses we expect <span class="math notranslate nohighlight">\(S\)</span> to decrease: unless people enter the population from outside, the number of susceptible people only goes down since once someone has been infected they don’t return to being susceptible again (having the disease makes you immune). Mathematically we can say that</p>
<div class="math notranslate nohighlight">
\[
    \Delta S = -p_{\mathit{infect}} \, SI
\]</div>
<p>with the minus sign indicating that <span class="math notranslate nohighlight">\(S\)</span> is getting smaller.</p>
<p>What about <span class="math notranslate nohighlight">\(I\)</span>? Every person who leaves <span class="math notranslate nohighlight">\(S\)</span> (and so ceases to be susceptible) becomes infected and so enters <span class="math notranslate nohighlight">\(I\)</span>. So we’d expect that the corresponding change in <span class="math notranslate nohighlight">\(I\)</span>, <span class="math notranslate nohighlight">\(\Delta I\)</span>, would <em>increase</em> the the same amount as <span class="math notranslate nohighlight">\(\Delta S\)</span> <em>decreased</em>, so as not to lose anyone from the population. But as well as contracting the disease, people also recover from it (or die): either way are “removed” from the population affected by the disease.</p>
<p>(Whether you recover or die is obviously quite important to you, but in either event you are no longer infected or susceptible and so take no further part in the spread of the infection. Epidemic modelling can seem quite heartless at times.)</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>In the computational epidemiology and network science literatures the
parameter we’ve called <span class="math notranslate nohighlight">\(p_{\mathit{infect}}\)</span> is usually denoted
<span class="math notranslate nohighlight">\(\beta\)</span>, while <span class="math notranslate nohighlight">\(p_{remove}\)</span> is denoted <span class="math notranslate nohighlight">\(\alpha\)</span>. It’s easier to
understand what’s going on if we spell the meaning of the symbols out.</p>
</div>
<p>How many people are removed? SIR assumes that, just as a fraction <span class="math notranslate nohighlight">\(p_{\mathit{infect}}\)</span> of contacts result in infection, a fraction <span class="math notranslate nohighlight">\(p_{remove}\)</span> of infected individuals are removed. So the size of <span class="math notranslate nohighlight">\(I\)</span> is <em>increased</em> by susceptible people becoming infected, and <em>reduced</em> by infected people becoming removed. Putting this together we get</p>
<div class="math notranslate nohighlight">
\[
    \Delta I = (p_{\mathit{infect}} \, SI) - (p_{remove} \, I)
\]</div>
<p>The final step in the model is to account for removal, whereby the size of <span class="math notranslate nohighlight">\(R\)</span> increases at the same rate as that of <span class="math notranslate nohighlight">\(I\)</span> decreases.</p>
<div class="math notranslate nohighlight">
\[
    \Delta R = p_{remove} \, I
\]</div>
<p>And that’s SIR: three equations that describe how the sizes of the three compartments change, and two parameters that define what fraction of contacts result in infections and what fraction of infections are removed in a given time period.</p>
<p>Looking at the maths immediately tells us some things about how an SIR epidemic will progress. Firstly, as we mentioned, the size of <span class="math notranslate nohighlight">\(S\)</span> always decreases, while the size of <span class="math notranslate nohighlight">\(R\)</span> clearly always increases: the only place where anything interesting can happen is in the size of <span class="math notranslate nohighlight">\(I\)</span>, whhich both increases <em>and</em> decreases.</p>
<p>Secondly, the rate at which <span class="math notranslate nohighlight">\(I\)</span> increases depends on how big <span class="math notranslate nohighlight">\(I\)</span> is already: a larger value of <span class="math notranslate nohighlight">\(I\)</span> makes for a larger value of <span class="math notranslate nohighlight">\(\Delta I\)</span>. But it’s a bit more complicated than that, since it also depends on the size of <span class="math notranslate nohighlight">\(S\)</span>, where a smaller value of <span class="math notranslate nohighlight">\(S\)</span> means a smaller value of <span class="math notranslate nohighlight">\(\Delta I\)</span> – and we know that <span class="math notranslate nohighlight">\(S\)</span> is always getting smaller. So these two terms – growing through infection and shrinking through removal – will fight it out as the disease progresses.</p>
<p>To summarise, we know that the sizes of <span class="math notranslate nohighlight">\(S\)</span>, <span class="math notranslate nohighlight">\(I\)</span>, and <span class="math notranslate nohighlight">\(R\)</span> will change over time. We know that <span class="math notranslate nohighlight">\(S\)</span> will shrink and <span class="math notranslate nohighlight">\(R\)</span> will grow, and <span class="math notranslate nohighlight">\(I\)</span> will … well, will do something that depends on the sizes of <span class="math notranslate nohighlight">\(S\)</span> and <span class="math notranslate nohighlight">\(I\)</span>. We also know that <span class="math notranslate nohighlight">\(I\)</span> grows at the same rate that <span class="math notranslate nohighlight">\(S\)</span> shrinks.</p>
<p>To find out exactly what happens, we need to explore these equations.</p>
</div>
<div class="section" id="the-computational-model">
<h2>The computational model<a class="headerlink" href="#the-computational-model" title="Permalink to this headline">¶</a></h2>
<p>To explore SIR, let’s turn the mathematical model of three equations into a computational model that “runs the numbers” to show how the epidemic progresses.</p>
<p>We can represent each of the three chanmges in population directly as Python functions. Since they share the parameters <span class="math notranslate nohighlight">\(p_{\mathit{infect}}\)</span> and <span class="math notranslate nohighlight">\(p_{remove}\)</span>, we’ll define them together using another function to which we pass the parameters and get back the change functions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">make_sir</span><span class="p">(</span><span class="n">pInfect</span><span class="p">,</span> <span class="n">pRemove</span><span class="p">):</span>
    <span class="c1"># turn the equations into update functions</span>
    <span class="k">def</span> <span class="nf">deltaS</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">R</span><span class="p">):</span>
        <span class="k">return</span> <span class="o">-</span><span class="n">pInfect</span> <span class="o">*</span> <span class="n">S</span> <span class="o">*</span> <span class="n">I</span>
    <span class="k">def</span> <span class="nf">deltaI</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">R</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">pInfect</span> <span class="o">*</span> <span class="n">S</span> <span class="o">*</span> <span class="n">I</span> <span class="o">-</span> <span class="n">pRemove</span> <span class="o">*</span> <span class="n">I</span>
    <span class="k">def</span> <span class="nf">deltaR</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">R</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">pRemove</span> <span class="o">*</span> <span class="n">I</span>
    
    <span class="c1"># return the three functions</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">deltaS</span><span class="p">,</span> <span class="n">deltaI</span><span class="p">,</span> <span class="n">deltaR</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We’ve used as far as possible the same names in the code as we did in the maths: <code class="docutils literal notranslate"><span class="pre">pInfect</span></code> for <span class="math notranslate nohighlight">\(p_{\mathit{infect}}\)</span>, <code class="docutils literal notranslate"><span class="pre">deltaS</span></code> for <span class="math notranslate nohighlight">\(\Delta S\)</span>, and so forth. This will help keep things straight in our minds.</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>This approach to integration to get a time series, known as the
<em>direct</em> or <em>Euler</em> method, isn’t safe in general, as it risks falling
foul of numerical instability in the equations. There are several more
robust solutions for the more complex cases, notably the Runge-Kutta
methods that are built into Python’s <code class="docutils literal notranslate"><span class="pre">scipy</span></code> library.</p>
</div>
<p>How do we “run” the epidemic? We’ve defined the ways in which the sizes of the sub-populations change. If we start with some initial sub-populations, we can then compute the change and add it to the previous population to get the population at the next timestep. We can do this repeatedly to trace out the behaviour of the epidemic in time. The result will be a time series for each sub-population tracking its size over time.</p>
<p>What should the initial sizes of the sub-populations be? Since we’re interested only in their sizes, we could say that given <span class="math notranslate nohighlight">\(N\)</span> individuals a fraction <span class="math notranslate nohighlight">\(p_{\mathit{infected}}\)</span> are initially infected, while everyone else is susceptible: no-one starts off removed.</p>
<p>We can code this behaviour up as a single function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">epidemic_sir</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">pInfected</span><span class="p">,</span> <span class="n">pInfect</span><span class="p">,</span> <span class="n">pRemove</span><span class="p">):</span>
    <span class="c1"># create the change functions for these parameters</span>
    <span class="p">(</span><span class="n">deltaS</span><span class="p">,</span> <span class="n">deltaI</span><span class="p">,</span> <span class="n">deltaR</span><span class="p">)</span> <span class="o">=</span> <span class="n">make_sir</span><span class="p">(</span><span class="n">pInfect</span><span class="p">,</span> <span class="n">pRemove</span><span class="p">)</span>
    
    <span class="c1"># initial conditions</span>
    <span class="n">sss</span> <span class="o">=</span> <span class="p">[</span> <span class="n">N</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">pInfected</span><span class="p">)</span> <span class="p">]</span>   <span class="c1"># everyone is initially susceptible...</span>
    <span class="n">iss</span> <span class="o">=</span> <span class="p">[</span> <span class="n">N</span> <span class="o">*</span> <span class="n">pInfected</span> <span class="p">]</span>           <span class="c1"># ...except for this fraction of people...</span>
    <span class="n">rss</span> <span class="o">=</span> <span class="p">[</span> <span class="mi">0</span> <span class="p">]</span>                       <span class="c1"># ...and no-one starts off removed</span>

    <span class="c1"># push the initial conditions through the equations</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
        <span class="c1"># apply the change functions to the sub-populations of </span>
        <span class="c1"># the previous timestep to compute the changes</span>
        <span class="n">ds</span> <span class="o">=</span> <span class="n">deltaS</span><span class="p">(</span><span class="n">sss</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">iss</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">rss</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">di</span> <span class="o">=</span> <span class="n">deltaI</span><span class="p">(</span><span class="n">sss</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">iss</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">rss</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">dr</span> <span class="o">=</span> <span class="n">deltaR</span><span class="p">(</span><span class="n">sss</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">iss</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">rss</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        
        <span class="c1"># the value at the next timestep are those at the previous</span>
        <span class="c1"># timestep plus the value of the change in that value</span>
        <span class="n">sss</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sss</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">ds</span><span class="p">)</span>
        <span class="n">iss</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iss</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">di</span><span class="p">)</span>
        <span class="n">rss</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rss</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dr</span><span class="p">)</span>
        
    <span class="c1"># return the time series</span>
    <span class="k">return</span> <span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="p">)),</span> <span class="n">sss</span><span class="p">,</span> <span class="n">iss</span><span class="p">,</span> <span class="n">rss</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We need the initial conditions for the simulation: the population size (which won;t change), the number of timesteps we want to run the simulation for, and the values of the three parameters <code class="docutils literal notranslate"><span class="pre">pInfected</span></code>, <code class="docutils literal notranslate"><span class="pre">pInfect</span></code>, and <code class="docutils literal notranslate"><span class="pre">pRemove</span></code>. For simplicity let’s fix all these apart from <code class="docutils literal notranslate"><span class="pre">pInfect</span></code>. We’ll start with <span class="math notranslate nohighlight">\(1/100\mathrm{th}\)</span> of the population infected (<code class="docutils literal notranslate"><span class="pre">pInfected</span> <span class="pre">=</span> <span class="pre">0.01</span></code>), and <span class="math notranslate nohighlight">\(1/1000\mathrm{th}\)</span> of the infected population recovering in each timestep (<code class="docutils literal notranslate"><span class="pre">pRemove</span> <span class="pre">=</span> <span class="pre">0.001</span></code>).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">T</span> <span class="o">=</span> <span class="mi">5000</span>
<span class="n">pInfected</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="n">pRemove</span> <span class="o">=</span> <span class="mf">0.001</span>
</pre></div>
</div>
</div>
</div>
<p>We can then choose different values of <code class="docutils literal notranslate"><span class="pre">pInfect</span></code> and see what the simulation shows us about the ways in which the sub-populations evolve.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
<span class="o">%</span><span class="n">config</span> <span class="n">InlineBackend</span><span class="o">.</span><span class="n">figure_format</span> <span class="o">=</span> <span class="s1">&#39;svg&#39;</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;seaborn&#39;</span><span class="p">)</span>

<span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>

<span class="c1"># draw the sub-plots for selected values of pInfect</span>
<span class="k">for</span> <span class="p">(</span><span class="n">pInfect</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span> <span class="p">(</span><span class="mf">0.0000010</span><span class="p">,</span> <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]),</span>
                       <span class="p">(</span><span class="mf">0.0000020</span><span class="p">,</span> <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]),</span>
                       <span class="p">(</span><span class="mf">0.0000035</span><span class="p">,</span> <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]),</span>
                       <span class="p">(</span><span class="mf">0.0000040</span><span class="p">,</span> <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]),</span>
                       <span class="p">(</span><span class="mf">0.0000050</span><span class="p">,</span> <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]),</span>
                       <span class="p">(</span><span class="mf">0.0000080</span><span class="p">,</span> <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="p">]:</span>
    <span class="c1"># run the epidemic equations</span>
    <span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">sss</span><span class="p">,</span> <span class="n">iss</span><span class="p">,</span> <span class="n">rss</span><span class="p">)</span> <span class="o">=</span> <span class="n">epidemic_sir</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">pInfected</span><span class="p">,</span> <span class="n">pInfect</span><span class="p">,</span> <span class="n">pRemove</span><span class="p">)</span>
    
    <span class="c1"># draw the graph in the sub-plot</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">sss</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;suceptible&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">iss</span><span class="p">,</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;infected&#39;</span><span class="p">)</span>
    <span class="c1">#ax.plot(ts, rss, &#39;k-&#39;, label=&#39;removed&#39;)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;$p_{</span><span class="se">\\</span><span class="s1">mathit</span><span class="si">{Infect}</span><span class="s1">} = &#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="si">{b:.7f}</span><span class="s1">$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="n">pInfect</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">N</span><span class="p">])</span>
    
<span class="c1"># fine-tune the figure</span>
<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Progress of epidemic for different $p_{</span><span class="se">\\</span><span class="s1">mathit</span><span class="si">{Infect}</span><span class="s1">})$ ($p_</span><span class="si">{remove}</span><span class="s1"> = &#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="si">{a}</span><span class="s1">$)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">pRemove</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]:</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;population that is...&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]:</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$t$&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;center left&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/continuous_16_0.svg" src="_images/continuous_16_0.svg" /></div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>We’ve engaged in some mathematical sleight-of-hand here, in that what
we’ve described as a <em>discrete</em> model (of people being susceptible,
infected, and so on) has then be treated as a <em>continuous</em> model that
represents the sizes of compartments as real numbers. In order to work
in this way the three SIR equations should really be be phrased as
<em>differential</em> equations rather than as <em>difference</em> equations so that
the passage from discrete to continuous time makes mathematical
sense. The results obtained are the same in both cases, however.</p>
</div>
<p>What are these graphs telling us? Start in the top left. At the start of the epidemic (when <span class="math notranslate nohighlight">\(t = 0\)</span>) we have a very small number of infected individuals and a very large number of susceptibles. The number of infecteds grows slowly as the time passes and the graph moves form left to right. But the disease is not very infectious: only 0.000001 of contacts leads to infection, just one in a million. At the start of the epidemic there are 990 susceptible people and 10 infecteds (1% of the total population), which means there can be at most 9900 susceptible-infected contacts. In the first timestep, then, the equations suggest that approximately 0.01 people become infected.</p>
<p>We can’t infect two-hundreths of a person, of course: clearly it will take some time for there to be one new person infected. And once infections start people also start to recover, and the epidemic clearly never gets going.</p>
<p>But now look at the next diagrams. Even for very modest values of <span class="math notranslate nohighlight">\(p_{\mathit{infect}}\)</span> – 0.000002 to 0.000008 – we get considerable epidemics. At the peak of infections around 40–60% of the population is infected, compared to essentially no-one for the smallest value of <span class="math notranslate nohighlight">\(p_{\mathit{infect}}\)</span>. And that’s with <span class="math notranslate nohighlight">\(p_{\mathit{infect}}\)</span> still tiny: eight contacts in every million resulting in an infection.</p>
</div>
<div class="section" id="consequences">
<h2>Consequences<a class="headerlink" href="#consequences" title="Permalink to this headline">¶</a></h2>
<p>Let those figures sink in for a moment.</p>
<p>The SIR model is telling us that changing the rate of infection from one in a million to eight in a million is enough to change the total proportion of infected people in a population from about 1% to about 60%! To put it another way, anything that changes the infection rate by even a miniscule amount can have an enormous, outsized, effect on the outbreak.</p>
<p>We have to be careful what we conclude, though. While we’va got  a “population” and some “contacts”, we haven’t said anything about the timescale over which we’re talking: it’s all been abstracted. So the “infection rate” is a somewhat notional concept that doesn’t directly relate to <em>any</em> particular rate or disease in the real world. It’s important to remember this and not draw any unsupported conclusions.</p>
<p>There <em>are</em> some conclusions that are supported, though. Firstly, we can see that the epidemic grows exponentially once it gets started. We can also see that it dies away exponentially after its peak. And e know that the population of infected people is a dynamic thing, with people recovering and new people being infected across the outbreak.</p>
</div>
</div>


              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="progress.html" title="previous page">The progession of a disease</a>
    <a class='right-next' id="next-link" href="network.html" title="next page">Network models</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Simon Dobson<br/>
        
            &copy; <a href="copyright.html">Copyright</a> 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="_static/js/index.js"></script>
    
  </body>
</html>